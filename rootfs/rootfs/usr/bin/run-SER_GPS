#!/bin/sh


# define a function to check fo the ttyGPS port
# wait for 10 seconds then try to bring it up again
# only checks for GOBI and Telit based GPS
#

if [ 'OFF' = "$FEATURE" ];then
	exit 0
fi

i=0
PROG_NAME='SER_GPS'
LOG="/var/log/"`echo -n $0|sed 's/.*\///'`".processlog"
LAST_MSG=''

while true
do
	i=`expr $i + 1`
	if [ -e "/home/root/log.enabled" ] ; then
		uptime > $LOG
		date >> $LOG
		echo "starts: $i" >> $LOG
		echo "lastmsg: $LAST_MSG" >> $LOG
	fi
	
	SER_GPS
	LAST_MSG="$PROG_NAME exited with code $?, restarting..."
	sleep 1
done
exit 0

