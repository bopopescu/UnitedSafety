#!/bin/bash
	. /usr/share/cross-compile/arm-sourcery-glibc/SOURCE_ME
	unset INSTALL
	./configure --host=arm-linux-gnu CC=${CROSS_COMPILE}gcc LD=${CROSS_COMPILE}ld AR=${CROSS_COMPILE}ar --prefix=/tmp/$(whoami)/xml2 CFLAGS='-Os'
	make -e -j$TRULINK_JOBS
	ret=$?

	if [ 0 != "$ret" ];then
		echo "\"make\" failed"
		exit $ret
	fi

	make install
	ret=$?
	if [ 0 != "$ret" ];then
		echo "\"make install\" failed"
		exit $ret
	fi

	if [ ! -e "$ROOTFS_DEF_DIR" ];then
		echo "Default rootfs directory \"$ROOTFS_DEF_DIR\" does not exist"
		exit 1
	fi

	APP=".libs/libxml2.so.2.9.0"
	sudo cp -av $APP "$ROOTFS_DEF_DIR/usr/lib/libxml2.so.2"
	if [ 0 != "$?" ];then
		echo "Failed to install \"$APP\""
		exit 1
	fi
exit 0
